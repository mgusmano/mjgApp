/*85b780ee8a84379a4a24bed5914933db97fd776e*/(function(b,c){$.Flips=function(d,e){this.$el=$(e);this._init(d)};$.Flips.defaults={flipspeed:900,fliptimingfunction:"linear",current:0};$.Flips.prototype={_init:function(d){this.options=$.extend(true,{},$.Flips.defaults,d);this.$pages=this.$el.children("div.f-page");this.pagesCount=this.$pages.length;this.currentPage=this.options.current;this._validateOpts();this._getWinSize();this._getState();this._layout();this._initTouchSwipe();this._loadEvents();this._goto()},_validateOpts:function(){if(this.currentPage<0||this.currentPage>this.pagesCount){this.currentPage=0}},_getWinSize:function(){var d=$(b);this.windowProp={width:d.width(),height:d.height()}},_goto:function(){var d=(this.state===c)?this.currentPage:this.state;if(!this._isNumber(d)||d<0||d>this.flipPagesCount){d=0}this.currentPage=d},_getState:function(){this.state=0},_isNumber:function(d){return parseFloat(d)==parseInt(d)&&!isNaN(d)&&isFinite(d)},_adjustLayout:function(e){var d=this;this.$flipPages.each(function(g){var f=$(this);if(g===e-1){f.css({"-webkit-transform":"rotateY( -180deg )","-moz-transform":"rotateY( -180deg )","z-index":d.flipPagesCount-1+g})}else{if(g<e){f.css({"-webkit-transform":"rotateY( -181deg )","-moz-transform":"rotateY( -181deg )","z-index":d.flipPagesCount-1+g})}else{f.css({"-webkit-transform":"rotateY( 0deg )","-moz-transform":"rotateY( 0deg )","z-index":d.flipPagesCount-1-g})}}})},_saveState:function(){},_layout:function(){this._setLayoutSize();for(var f=0;f<=this.pagesCount-2;++f){var d=this.$pages.eq(f),e={theClass:"page",theContentFront:d.html(),theContentBack:(f!==this.pagesCount)?this.$pages.eq(f+1).html():"",theStyle:"z-index: "+(this.pagesCount-f)+";left: "+(this.windowProp.width/2)+"px;",theContentStyleFront:"width:"+this.windowProp.width+"px;",theContentStyleBack:"width:"+this.windowProp.width+"px;"};if(f===0){e.theClass+=" cover"}else{e.theContentStyleFront+="left:-"+(this.windowProp.width/2)+"px";if(f===this.pagesCount-2){e.theClass+=" cover-back"}}$("#pageTmpl").tmpl(e).appendTo(this.$el)}this.$pages.remove();this.$flipPages=this.$el.children("div.page");this.flipPagesCount=this.$flipPages.length;this._adjustLayout((this.state===c)?this.currentPage:this.state)},_setLayoutSize:function(){this.$el.css({width:this.windowProp.width,height:this.windowProp.height})},_initTouchSwipe:function(){var d=this;this.$el.swipe({threshold:0,swipeStatus:function(g,t,h,m,r,f){var n=h.x,u=m.x,i,l,k=false,o=false;if(!d._isAnimating()){(n<d.windowProp.width/2)?d.flipSide="l2r":d.flipSide="r2l"}if(r==="up"||r==="down"){if(d.angle===c||d.angle===0){d._removeOverlays();return false}else{(d.angle<90)?r="right":r="left"}}d.flipDirection=r;if(d.currentPage===0&&d.flipSide==="l2r"||d.currentPage===d.flipPagesCount&&d.flipSide==="r2l"){return false}i=d.windowProp.width-n;var q=0.9*(d.windowProp.width/2);if(Math.abs(n-i)<q){(d.flipSide==="r2l")?i-=q/2:i+=q/2}if(u>n&&d.flipSide==="r2l"){l=0;k=true;o=true}else{if(u<i&&d.flipSide==="r2l"){l=180;k=true}else{if(u>i&&d.flipSide==="l2r"){l=0;k=true}else{if(u<n&&d.flipSide==="l2r"){l=180;k=true;o=true}else{var v,p,j;(d.flipSide==="r2l")?(v=n,p=i,j=n-f):(v=i,p=n,j=n+f);l=d._calcAngle(j,v,p);if((r==="left"&&d.flipSide==="l2r")||(r==="right"&&d.flipSide==="r2l")){o=true}}}}}switch(t){case"start":if(d._isAnimating()){d.start=true;return false}else{d.start=false}d._setFlippingPage();d.$beforePage=d.$flippingPage.prev();d.$afterPage=d.$flippingPage.next();break;case"move":if(f>0){if(d._isAnimating()||d.start){return false}if(!d.hasOverlays){d._addOverlays()}d.angle=l;d._turnPage(l,true)}break;case"end":if(f>0){if(d._isAnimating()||d.start){return false}d.isAnimating=true;(o)?d.$flippingPage.data("flip",false):d.$flippingPage.data("flip",true);if(k){if(!o){d._updatePage()}d._onEndFlip(d.$flippingPage)}else{d.angle=l;d._calculateSpeed();switch(r){case"left":d._turnPage(180);if(d.flipSide==="r2l"){d._updatePage()}break;case"right":d._turnPage(0);if(d.flipSide==="l2r"){d._updatePage()}break}}}break}}})},_setFlippingPage:function(){var d=this;(this.flipSide==="l2r")?this.$flippingPage=this.$flipPages.eq(this.currentPage-1):this.$flippingPage=this.$flipPages.eq(this.currentPage);this.$flippingPage.on("webkitTransitionEnd.flips transitionend.flips OTransitionEnd.flips",function(e){if($(e.target).hasClass("page")){d._onEndFlip($(this))}})},_updatePage:function(){if(this.flipSide==="r2l"){++this.currentPage}else{if(this.flipSide==="l2r"){--this.currentPage}}},_isAnimating:function(){if(this.isAnimating){return true}return false},_loadEvents:function(){var d=this;$(b).on("resize.flips",function(g){d._getWinSize();d._setLayoutSize();var f=d.$flipPages.children("div.front").find("div.content"),e=d.$flipPages.children("div.back").find("div.content");d.$flipPages.css("left",d.windowProp.width/2);f.filter(function(h){return h>0}).css({width:d.windowProp.width,left:-d.windowProp.width/2});f.eq(0).css("width",d.windowProp.width);e.css("width",d.windowProp.width)});$(b).on("statechange.flips",function(e){d._getState();d._goto();if(!d.isAnimating){d._adjustLayout(d.currentPage)}});this.$flipPages.find(".box").on("click.flips",function(i){var j=$(this),h=$('<span class="box-close">close</span>'),f={speed:450,timingfunction:"linear"},e=$('<div class="overlay">close</div>').css({"z-index":9998,"-webkit-transition":"opacity "+f.speed+"ms "+f.timingfunction,"-moz-transition":"opacity "+f.speed+"ms "+f.timingfunction}).prependTo($("body")),k={width:j.outerWidth(true),height:j.outerHeight(true),left:j.offset().left,top:j.offset().top},g=j.clone().css({position:"absolute",width:k.width,height:k.height,left:k.left,top:k.top,zIndex:9999,"overflow-y":"auto","-webkit-transition":"all "+f.speed+"ms "+f.timingfunction,"-moz-transition":"all "+f.speed+"ms "+f.timingfunction}).insertAfter(e).end().append(h.on("click.flips",function(l){e.css("opacity",0);g.children().hide().end().removeClass("box-expanded").css({width:d.windowProp.width,height:d.windowProp.height,"overflow-y":"hidden"});setTimeout(function(){g.css({left:k.left,top:k.top,width:k.width,height:k.height,"-webkit-transition":"all "+f.speed+"ms "+f.timingfunction,"-moz-transition":"all "+f.speed+"ms "+f.timingfunction})},0)})).children().hide().end().on("webkitTransitionEnd.flips transitionend.flips OTransitionEnd.flips",function(l){if($(l.target).hasClass("box-expanded")){$(this).css({width:"100%",height:"100%","-webkit-transition":"none","-moz-transition":"none"}).children().fadeIn()}else{e.remove();$(this).remove()}});setTimeout(function(){e.css({opacity:1});g.addClass("box-expanded").css({left:0,top:0,width:d.windowProp.width,height:d.windowProp.height})},0)})},_onEndFlip:function(d){if((this.flipSide==="l2r"&&d.data("flip"))||(this.flipSide==="r2l"&&!d.data("flip"))){d.css("z-index",this.pagesCount-2-d.index())}this.$flippingPage.css({"-webkit-transition":"none","-moz-transition":"none"});this._removeOverlays();this._saveState();this.isAnimating=false;if(this.flipSide==="r2l"||(this.flipSide==="l2r"&&!d.data("flip"))){this.$flippingPage.find(".back").css("-webkit-transform","rotateY(-180deg)")}},_calcAngle:function(d,f,g){return(-180/(f-g))*d+((f*180)/(f-g))},_calculateSpeed:function(){(this.flipDirection==="right")?this.flipSpeed=(this.options.flipspeed/180)*this.angle:this.flipSpeed=-(this.options.flipspeed/180)*this.angle+this.options.flipspeed},_turnPage:function(e,f){this.$beforePage.css({"-webkit-transform":"rotateY( -180deg )","-moz-transform":"rotateY( -180deg )"});if(!f){this.$flippingPage.css({"-webkit-transition":"-webkit-transform "+this.flipSpeed+"ms "+this.options.fliptimingfunction,"-moz-transition":"-moz-transform "+this.flipSpeed+"ms "+this.options.fliptimingfunction})}var d=(this.flipSide==="r2l")?this.currentPage:this.currentPage-1;if(this.flipSide==="r2l"){this.$flippingPage.css("z-index",this.flipPagesCount-1+d)}this.$flippingPage.find(".back").css("-webkit-transform","rotateY(180deg)");this.$flippingPage.css({"-webkit-transform":"rotateY(-"+e+"deg)","-moz-transform":"rotateY(-"+e+"deg)"});this._overlay(e,f)},_addOverlays:function(){var d=this;this._removeOverlays();this.hasOverlays=true;this.$frontoverlay=$('<div class="flipoverlay"></div>').appendTo(this.$flippingPage.find("div.front > .outer"));this.$backoverlay=$('<div class="flipoverlay"></div>').appendTo(this.$flippingPage.find("div.back > .outer"));if(this.$afterPage){this.$afterOverlay=$('<div class="overlay"></div>').appendTo(this.$afterPage.find("div.front > .outer"))}if(this.$beforePage){this.$beforeOverlay=$('<div class="overlay"></div>').appendTo(this.$beforePage.find("div.back > .outer"))}},_removeOverlays:function(){if(this.$frontoverlay){this.$frontoverlay.remove()}if(this.$backoverlay){this.$backoverlay.remove()}if(this.$afterOverlay){this.$afterOverlay.remove()}if(this.$beforeOverlay){this.$beforeOverlay.remove()}this.hasOverlays=false},_overlay:function(j,l){if(l){var e=-(1/90)*j+1,m=(1/90)*j-1;if(this.$afterOverlay){this.$afterOverlay.css("opacity",e)}if(this.$beforeOverlay){this.$beforeOverlay.css("opacity",m)}var g=0.1;this.$frontoverlay.css("opacity",g);this.$backoverlay.css("opacity",g)}else{var n=this;var f=this.flipSpeed,d=this.flipSpeed,k=60;if(this.$afterOverlay){var i=0;if(this.flipDirection==="right"){if(this.angle>90){i=Math.abs(this.flipSpeed-this.options.flipspeed/2-k);f=this.options.flipspeed/2-k}else{f-=k}}else{f=Math.abs(this.flipSpeed-this.options.flipspeed/2)}if(f<=0){f=1}this.$afterOverlay.css({"-webkit-transition":"opacity "+f+"ms "+this.options.fliptimingfunction+" "+i+"ms","-moz-transition":"opacity "+f+"ms "+this.options.fliptimingfunction+" "+i+"ms",opacity:(this.flipDirection==="left")?0:1}).on("webkitTransitionEnd.flips transitionend.flips OTransitionEnd.flips",function(o){if(n.$beforeOverlay){n.$beforeOverlay.off("webkitTransitionEnd.flips transitionend.flips OTransitionEnd.flips")}setTimeout(function(){n._adjustLayout(n.currentPage)},n.options.flipspeed/2-k)})}if(this.$beforeOverlay){var h=0;if(this.flipDirection==="left"){if(this.angle<90){h=Math.abs(this.flipSpeed-this.options.flipspeed/2-k);d=this.options.flipspeed/2-k}else{d-=k}}else{d=Math.abs(this.flipSpeed-this.options.flipspeed/2)}if(d<=0){d=1}this.$beforeOverlay.css({"-webkit-transition":"opacity "+d+"ms "+this.options.fliptimingfunction+" "+h+"ms","-moz-transition":"opacity "+d+"ms "+this.options.fliptimingfunction+" "+h+"ms",opacity:(this.flipDirection==="left")?1:0}).on("webkitTransitionEnd.flips transitionend.flips OTransitionEnd.flips",function(o){if(n.$afterOverlay){n.$afterOverlay.off("webkitTransitionEnd.flips transitionend.flips OTransitionEnd.flips")}n._adjustLayout(n.currentPage)})}}}};var a=function(d){if(this.console){console.error(d)}};$.fn.flips=function(e){if(typeof e==="string"){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var f=$.data(this,"flips");if(!f){a("cannot call methods on flips prior to initialization; attempted to call method '"+e+"'");return}if(!$.isFunction(f[e])||e.charAt(0)==="_"){a("no such method '"+e+"' for flips instance");return}f[e].apply(f,d)})}else{this.each(function(){var f=$.data(this,"flips");if(!f){$.data(this,"flips",new $.Flips(e,this))}})}return this}})(window);